"use strict";
/* eslint-disable @typescript-eslint/no-var-requires */
/* eslint-disable global-require */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.build = void 0;
const webpack_1 = __importDefault(require("webpack"));
const getProdConfig_1 = __importDefault(require("../webpack/getProdConfig"));
const find_1 = __importDefault(require("../config/find"));
const load_1 = __importDefault(require("../config/load"));
const configPath = find_1.default();
const build = () => {
    try {
        const config = load_1.default();
        const webpackProdConfig = getProdConfig_1.default({
            ...config,
            paths: {
                ...(config.paths || {}),
                config: configPath,
            },
        });
        webpack_1.default(webpackProdConfig, (err, stats) => {
            if (err || stats.hasErrors()) {
                // Handle errors here
                if (stats) {
                    console.error(stats.toString({
                        chunks: false,
                        colors: true,
                    }));
                }
                else {
                    console.error(err.message);
                }
            }
        });
    }
    catch (err) {
        console.error(err);
        console.error(`Error: can't find the configuration file located at ${configPath}.`);
    }
};
exports.build = build;
// when build.js is launched directly
if (module.id === require.main.id) {
    exports.build();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYmluL2J1aWxkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSx1REFBdUQ7QUFDdkQsbUNBQW1DOzs7Ozs7QUFFbkMsc0RBQThCO0FBQzlCLDZFQUE0RDtBQUM1RCwwREFBd0M7QUFDeEMsMERBQXdDO0FBRXhDLE1BQU0sVUFBVSxHQUFHLGNBQVUsRUFBRSxDQUFDO0FBRXpCLE1BQU0sS0FBSyxHQUFHLEdBQVMsRUFBRTtJQUM5QixJQUFJO1FBQ0YsTUFBTSxNQUFNLEdBQUcsY0FBVSxFQUFFLENBQUM7UUFDNUIsTUFBTSxpQkFBaUIsR0FBRyx1QkFBb0IsQ0FBQztZQUM3QyxHQUFHLE1BQU07WUFDVCxLQUFLLEVBQUU7Z0JBQ0wsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLElBQUksRUFBRSxDQUFDO2dCQUN2QixNQUFNLEVBQUUsVUFBVTthQUNuQjtTQUNGLENBQUMsQ0FBQztRQUVILGlCQUFPLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDeEMsSUFBSSxHQUFHLElBQUksS0FBSyxDQUFDLFNBQVMsRUFBRSxFQUFFO2dCQUM1QixxQkFBcUI7Z0JBRXJCLElBQUksS0FBSyxFQUFFO29CQUNULE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQzt3QkFDM0IsTUFBTSxFQUFFLEtBQUs7d0JBQ2IsTUFBTSxFQUFFLElBQUk7cUJBQ2IsQ0FBQyxDQUFDLENBQUM7aUJBQ0w7cUJBQU07b0JBQ0wsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7aUJBQzVCO2FBQ0Y7UUFDSCxDQUFDLENBQUMsQ0FBQztLQUNKO0lBQUMsT0FBTyxHQUFHLEVBQUU7UUFDWixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ25CLE9BQU8sQ0FBQyxLQUFLLENBQUMsdURBQXVELFVBQVUsR0FBRyxDQUFDLENBQUM7S0FDckY7QUFDSCxDQUFDLENBQUM7QUE3QlcsUUFBQSxLQUFLLFNBNkJoQjtBQUVGLHFDQUFxQztBQUNyQyxJQUFJLE1BQU0sQ0FBQyxFQUFFLEtBQUssT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDakMsYUFBSyxFQUFFLENBQUM7Q0FDVCJ9