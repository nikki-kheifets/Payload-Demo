"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const graphql_scalars_1 = require("graphql-scalars");
const graphql_1 = require("graphql");
const formatName_1 = __importDefault(require("../../graphql/utilities/formatName"));
const buildPaginatedListType_1 = __importDefault(require("../../graphql/schema/buildPaginatedListType"));
function registerCollections() {
    const { create, find, findByID, deleteResolver, update, } = this.graphQL.resolvers.collections;
    const { login, logout, me, init, refresh, forgotPassword, resetPassword, verifyEmail, unlock, } = this.graphQL.resolvers.collections.auth;
    Object.keys(this.collections).forEach((slug) => {
        const collection = this.collections[slug];
        const { config: { labels: { singular, plural, }, fields: initialFields, timestamps, }, } = collection;
        const fields = [...initialFields];
        const singularLabel = formatName_1.default(singular);
        let pluralLabel = formatName_1.default(plural);
        // For collections named 'Media' or similar,
        // there is a possibility that the singular name
        // will equal the plural name. Append `all` to the beginning
        // of potential conflicts
        if (singularLabel === pluralLabel) {
            pluralLabel = `all${singularLabel}`;
        }
        collection.graphQL = {};
        const baseFields = {
            id: {
                type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString),
            },
        };
        const whereInputFields = [
            ...fields,
        ];
        if (timestamps) {
            baseFields.createdAt = {
                type: new graphql_1.GraphQLNonNull(graphql_scalars_1.DateTimeResolver),
            };
            baseFields.updatedAt = {
                type: new graphql_1.GraphQLNonNull(graphql_scalars_1.DateTimeResolver),
            };
            whereInputFields.push({
                name: 'createdAt',
                label: 'Created At',
                type: 'date',
            });
            whereInputFields.push({
                name: 'updatedAt',
                label: 'Upated At',
                type: 'date',
            });
        }
        collection.graphQL.type = this.buildObjectType(singularLabel, fields, singularLabel, baseFields);
        collection.graphQL.whereInputType = this.buildWhereInputType(singularLabel, whereInputFields, singularLabel);
        if (collection.config.auth) {
            fields.push({
                name: 'password',
                label: 'Password',
                type: 'text',
                required: true,
            });
        }
        collection.graphQL.mutationInputType = new graphql_1.GraphQLNonNull(this.buildMutationInputType(singularLabel, fields, singularLabel));
        collection.graphQL.updateMutationInputType = new graphql_1.GraphQLNonNull(this.buildMutationInputType(`${singularLabel}Update`, fields, `${singularLabel}Update`, true));
        this.Query.fields[singularLabel] = {
            type: collection.graphQL.type,
            args: {
                id: { type: graphql_1.GraphQLString },
                ...(this.config.localization ? {
                    locale: { type: this.types.localeInputType },
                    fallbackLocale: { type: this.types.fallbackLocaleInputType },
                } : {}),
            },
            resolve: findByID(collection),
        };
        this.Query.fields[pluralLabel] = {
            type: buildPaginatedListType_1.default(pluralLabel, collection.graphQL.type),
            args: {
                where: { type: collection.graphQL.whereInputType },
                ...(this.config.localization ? {
                    locale: { type: this.types.localeInputType },
                    fallbackLocale: { type: this.types.fallbackLocaleInputType },
                } : {}),
                page: { type: graphql_1.GraphQLInt },
                limit: { type: graphql_1.GraphQLInt },
                sort: { type: graphql_1.GraphQLString },
            },
            resolve: find(collection),
        };
        this.Mutation.fields[`create${singularLabel}`] = {
            type: collection.graphQL.type,
            args: {
                data: { type: collection.graphQL.mutationInputType },
            },
            resolve: create(collection),
        };
        this.Mutation.fields[`update${singularLabel}`] = {
            type: collection.graphQL.type,
            args: {
                id: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                data: { type: collection.graphQL.updateMutationInputType },
            },
            resolve: update(collection),
        };
        this.Mutation.fields[`delete${singularLabel}`] = {
            type: collection.graphQL.type,
            args: {
                id: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
            },
            resolve: deleteResolver(collection),
        };
        if (collection.config.auth) {
            collection.graphQL.JWT = this.buildObjectType(formatName_1.default(`${slug}JWT`), collection.config.fields.filter((field) => field.saveToJWT).concat([
                {
                    name: 'email',
                    type: 'email',
                    required: true,
                },
                {
                    name: 'collection',
                    type: 'text',
                    required: true,
                },
            ]), formatName_1.default(`${slug}JWT`));
            this.Query.fields[`me${singularLabel}`] = {
                type: new graphql_1.GraphQLObjectType({
                    name: formatName_1.default(`${slug}Me`),
                    fields: {
                        token: {
                            type: graphql_1.GraphQLString,
                        },
                        user: {
                            type: collection.graphQL.type,
                        },
                        exp: {
                            type: graphql_1.GraphQLInt,
                        },
                        collection: {
                            type: graphql_1.GraphQLString,
                        },
                    },
                }),
                resolve: me(slug),
            };
            if (collection.config.auth.maxLoginAttempts > 0) {
                this.Mutation.fields[`unlock${singularLabel}`] = {
                    type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLBoolean),
                    args: {
                        email: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                    },
                    resolve: unlock(collection),
                };
            }
            this.Query.fields[`initialized${singularLabel}`] = {
                type: graphql_1.GraphQLBoolean,
                resolve: init(collection),
            };
            this.Mutation.fields[`login${singularLabel}`] = {
                type: new graphql_1.GraphQLObjectType({
                    name: formatName_1.default(`${slug}LoginResult`),
                    fields: {
                        token: {
                            type: graphql_1.GraphQLString,
                        },
                        user: {
                            type: collection.graphQL.type,
                        },
                        exp: {
                            type: graphql_1.GraphQLInt,
                        },
                    },
                }),
                args: {
                    email: { type: graphql_1.GraphQLString },
                    password: { type: graphql_1.GraphQLString },
                },
                resolve: login(collection),
            };
            this.Mutation.fields[`logout${singularLabel}`] = {
                type: graphql_1.GraphQLString,
                resolve: logout(collection),
            };
            this.Mutation.fields[`forgotPassword${singularLabel}`] = {
                type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLBoolean),
                args: {
                    email: { type: new graphql_1.GraphQLNonNull(graphql_1.GraphQLString) },
                    disableEmail: { type: graphql_1.GraphQLBoolean },
                    expiration: { type: graphql_1.GraphQLInt },
                },
                resolve: forgotPassword(collection),
            };
            this.Mutation.fields[`resetPassword${singularLabel}`] = {
                type: new graphql_1.GraphQLObjectType({
                    name: formatName_1.default(`${slug}ResetPassword`),
                    fields: {
                        token: { type: graphql_1.GraphQLString },
                        user: { type: collection.graphQL.type },
                    },
                }),
                args: {
                    token: { type: graphql_1.GraphQLString },
                    password: { type: graphql_1.GraphQLString },
                },
                resolve: resetPassword(collection),
            };
            this.Mutation.fields[`verifyEmail${singularLabel}`] = {
                type: graphql_1.GraphQLBoolean,
                args: {
                    token: { type: graphql_1.GraphQLString },
                },
                resolve: verifyEmail(collection),
            };
            this.Mutation.fields[`refreshToken${singularLabel}`] = {
                type: new graphql_1.GraphQLObjectType({
                    name: formatName_1.default(`${slug}Refreshed${singularLabel}`),
                    fields: {
                        user: {
                            type: collection.graphQL.JWT,
                        },
                        refreshedToken: {
                            type: graphql_1.GraphQLString,
                        },
                        exp: {
                            type: graphql_1.GraphQLInt,
                        },
                    },
                }),
                args: {
                    token: { type: graphql_1.GraphQLString },
                },
                resolve: refresh(collection),
            };
        }
    });
}
exports.default = registerCollections;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5pdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb2xsZWN0aW9ucy9ncmFwaHFsL2luaXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxxREFBbUQ7QUFDbkQscUNBQXVHO0FBRXZHLG9GQUE0RDtBQUM1RCx5R0FBaUY7QUFHakYsU0FBUyxtQkFBbUI7SUFDMUIsTUFBTSxFQUNKLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLGNBQWMsRUFBRSxNQUFNLEdBQy9DLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDO0lBRXZDLE1BQU0sRUFDSixLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLGNBQWMsRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLE1BQU0sR0FDckYsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO0lBRTVDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO1FBQzdDLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsTUFBTSxFQUNKLE1BQU0sRUFBRSxFQUNOLE1BQU0sRUFBRSxFQUNOLFFBQVEsRUFDUixNQUFNLEdBQ1AsRUFDRCxNQUFNLEVBQUUsYUFBYSxFQUNyQixVQUFVLEdBQ1gsR0FDRixHQUFHLFVBQVUsQ0FBQztRQUVmLE1BQU0sTUFBTSxHQUFHLENBQUMsR0FBRyxhQUFhLENBQUMsQ0FBQztRQUVsQyxNQUFNLGFBQWEsR0FBRyxvQkFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzNDLElBQUksV0FBVyxHQUFHLG9CQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFckMsNENBQTRDO1FBQzVDLGdEQUFnRDtRQUNo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