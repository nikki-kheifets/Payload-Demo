"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const autoRemoveVerificationToken = ({ originalDoc, data, value, operation }) => {
    // If a user manually sets `_verified` to true,
    // and it was `false`, set _verificationToken to `null`.
    // This is useful because the admin panel
    // allows users to set `_verified` to true manually
    if (operation === 'update') {
        if ((data === null || data === void 0 ? void 0 : data._verified) === true && (originalDoc === null || originalDoc === void 0 ? void 0 : originalDoc._verified) === false) {
            return null;
        }
    }
    return value;
};
exports.default = [
    {
        name: '_verified',
        type: 'checkbox',
        access: {
            create: () => false,
            update: ({ req: { user } }) => Boolean(user),
            read: ({ req: { user } }) => Boolean(user),
        },
        admin: {
            components: {
                Field: () => null,
            },
        },
    },
    {
        name: '_verificationToken',
        type: 'text',
        hidden: true,
        hooks: {
            beforeChange: [
                autoRemoveVerificationToken,
            ],
        },
    },
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZVZlcmlmaWNhdGlvbkZpZWxkcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9maWVsZHMvYmFzZUZpZWxkcy9iYXNlVmVyaWZpY2F0aW9uRmllbGRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRUEsTUFBTSwyQkFBMkIsR0FBYyxDQUFDLEVBQUUsV0FBVyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRTtJQUN6RiwrQ0FBK0M7SUFDL0Msd0RBQXdEO0lBQ3hELHlDQUF5QztJQUN6QyxtREFBbUQ7SUFFbkQsSUFBSSxTQUFTLEtBQUssUUFBUSxFQUFFO1FBQzFCLElBQUksQ0FBQSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsU0FBUyxNQUFLLElBQUksSUFBSSxDQUFBLFdBQVcsYUFBWCxXQUFXLHVCQUFYLFdBQVcsQ0FBRSxTQUFTLE1BQUssS0FBSyxFQUFFO1lBQ2hFLE9BQU8sSUFBSSxDQUFDO1NBQ2I7S0FDRjtJQUVELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQyxDQUFDO0FBRUYsa0JBQWU7SUFDYjtRQUNFLElBQUksRUFBRSxXQUFXO1FBQ2pCLElBQUksRUFBRSxVQUFVO1FBQ2hCLE1BQU0sRUFBRTtZQUNOLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxLQUFLO1lBQ25CLE1BQU0sRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztZQUM1QyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUM7U0FDM0M7UUFDRCxLQUFLLEVBQUU7WUFDTCxVQUFVLEVBQUU7Z0JBQ1YsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUk7YUFDbEI7U0FDRjtLQUNGO0lBQ0Q7UUFDRSxJQUFJLEVBQUUsb0JBQW9CO1FBQzFCLElBQUksRUFBRSxNQUFNO1FBQ1osTUFBTSxFQUFFLElBQUk7UUFDWixLQUFLLEVBQUU7WUFDTCxZQUFZLEVBQUU7Z0JBQ1osMkJBQTJCO2FBQzVCO1NBQ0Y7S0FDRjtDQUNTLENBQUMifQ==