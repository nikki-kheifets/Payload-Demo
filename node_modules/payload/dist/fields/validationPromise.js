"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const validationPromise = async ({ errors, hook, newData, existingData, field, path, skipValidation, }) => {
    if (hook !== 'beforeChange' || skipValidation)
        return true;
    const hasCondition = field.admin && field.admin.condition;
    const shouldValidate = field.validate && !hasCondition;
    let valueToValidate = newData === null || newData === void 0 ? void 0 : newData[field.name];
    if (valueToValidate === undefined)
        valueToValidate = existingData === null || existingData === void 0 ? void 0 : existingData[field.name];
    if (valueToValidate === undefined)
        valueToValidate = field.defaultValue;
    const result = shouldValidate ? await field.validate(valueToValidate, field) : true;
    if (typeof result === 'string') {
        errors.push({
            message: result,
            field: `${path}${field.name}`,
        });
    }
    return result;
};
exports.default = validationPromise;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGlvblByb21pc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZmllbGRzL3ZhbGlkYXRpb25Qcm9taXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBWUEsTUFBTSxpQkFBaUIsR0FBRyxLQUFLLEVBQUUsRUFDL0IsTUFBTSxFQUNOLElBQUksRUFDSixPQUFPLEVBQ1AsWUFBWSxFQUNaLEtBQUssRUFDTCxJQUFJLEVBQ0osY0FBYyxHQUNKLEVBQTZCLEVBQUU7SUFDekMsSUFBSSxJQUFJLEtBQUssY0FBYyxJQUFJLGNBQWM7UUFBRSxPQUFPLElBQUksQ0FBQztJQUUzRCxNQUFNLFlBQVksR0FBRyxLQUFLLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDO0lBQzFELE1BQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxRQUFRLElBQUksQ0FBQyxZQUFZLENBQUM7SUFFdkQsSUFBSSxlQUFlLEdBQUcsT0FBTyxhQUFQLE9BQU8sdUJBQVAsT0FBTyxDQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM1QyxJQUFJLGVBQWUsS0FBSyxTQUFTO1FBQUUsZUFBZSxHQUFHLFlBQVksYUFBWixZQUFZLHVCQUFaLFlBQVksQ0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDaEYsSUFBSSxlQUFlLEtBQUssU0FBUztRQUFFLGVBQWUsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDO0lBRXhFLE1BQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBRXBGLElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFO1FBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDVixPQUFPLEVBQUUsTUFBTTtZQUNmLEtBQUssRUFBRSxHQUFHLElBQUksR0FBRyxLQUFLLENBQUMsSUFBSSxFQUFFO1NBQzlCLENBQUMsQ0FBQztLQUNKO0lBRUQsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQyxDQUFDO0FBRUYsa0JBQWUsaUJBQWlCLENBQUMifQ==