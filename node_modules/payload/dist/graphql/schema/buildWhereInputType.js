"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/* eslint-disable no-use-before-define */
const graphql_1 = require("graphql");
const graphql_type_json_1 = require("graphql-type-json");
const graphql_scalars_1 = require("graphql-scalars");
const types_1 = require("../../fields/config/types");
const formatName_1 = __importDefault(require("../utilities/formatName"));
const combineParentName_1 = __importDefault(require("../utilities/combineParentName"));
const withOperators_1 = __importDefault(require("./withOperators"));
// buildWhereInputType is similar to buildObjectType and operates
// on a field basis with a few distinct differences.
//
// 1. Everything needs to be a GraphQLInputObjectType or scalar / enum
// 2. Relationships, groups, repeaters and flex content are not
//    directly searchable. Instead, we need to build a chained pathname
//    using dot notation so Mongo can properly search nested paths.
const buildWhereInputType = (name, fields, parentName) => {
    // This is the function that builds nested paths for all
    // field types with nested paths.
    const recursivelyBuildNestedPaths = (field) => {
        const nestedPaths = field.fields.reduce((nestedFields, nestedField) => {
            const getFieldSchema = fieldToSchemaMap[nestedField.type];
            const nestedFieldName = `${field.name}__${nestedField.name}`;
            if (getFieldSchema) {
                const fieldSchema = getFieldSchema({
                    ...nestedField,
                    name: nestedFieldName,
                });
                if (Array.isArray(fieldSchema)) {
                    return [
                        ...nestedFields,
                        ...fieldSchema,
                    ];
                }
                return [
                    ...nestedFields,
                    {
                        key: nestedFieldName,
                        type: fieldSchema,
                    },
                ];
            }
            return nestedFields;
        }, []);
        return nestedPaths;
    };
    const operators = {
        equality: ['equals', 'not_equals'],
        contains: ['in', 'not_in', 'all'],
        comparison: ['greater_than_equal', 'greater_than', 'less_than_equal', 'less_than'],
    };
    const fieldToSchemaMap = {
        number: (field) => {
            const type = graphql_1.GraphQLFloat;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, ...operators.comparison]),
            };
        },
        text: (field) => {
            const type = graphql_1.GraphQLString;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, 'like']),
            };
        },
        email: (field) => {
            const type = graphql_scalars_1.EmailAddressResolver;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, 'like']),
            };
        },
        textarea: (field) => {
            const type = graphql_1.GraphQLString;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, 'like']),
            };
        },
        richText: (field) => {
            const type = graphql_type_json_1.GraphQLJSON;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, 'like']),
            };
        },
        code: (field) => {
            const type = graphql_1.GraphQLString;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, 'like']),
            };
        },
        radio: (field) => ({
            type: withOperators_1.default(field, new graphql_1.GraphQLEnumType({
                name: `${combineParentName_1.default(parentName, field.name)}_Input`,
                values: field.options.reduce((values, option) => {
                    if (types_1.optionIsObject(option)) {
                        return {
                            ...values,
                            [formatName_1.default(option.value)]: {
                                value: option.value,
                            },
                        };
                    }
                    return {
                        ...values,
                        [formatName_1.default(option)]: {
                            value: option,
                        },
                    };
                }, {}),
            }), parentName, [...operators.equality, 'like']),
        }),
        date: (field) => {
            const type = graphql_scalars_1.DateTimeResolver;
            return {
                type: withOperators_1.default(field, type, parentName, [...operators.equality, ...operators.comparison, 'like']),
            };
        },
        relationship: (field) => {
            let type = withOperators_1.default(field, graphql_1.GraphQLString, parentName, [...operators.equality, ...operators.contains]);
            if (Array.isArray(field.relationTo)) {
                type = new graphql_1.GraphQLInputObjectType({
                    name: `${combineParentName_1.default(parentName, field.name)}_Relation`,
                    fields: {
                        relationTo: {
                            type: new graphql_1.GraphQLEnumType({
                                name: `${combineParentName_1.default(parentName, field.name)}_Relation_RelationTo`,
                                values: field.relationTo.reduce((values, relation) => ({
                                    ...values,
                                    [formatName_1.default(relation)]: {
                                        value: relation,
                                    },
                                }), {}),
                            }),
                        },
                        value: { type: graphql_1.GraphQLString },
                    },
                });
            }
            if (field.hasMany) {
                return {
                    type: new graphql_1.GraphQLList(type),
                };
            }
            return { type };
        },
        upload: (field) => ({
            type: withOperators_1.default(field, graphql_1.GraphQLString, parentName, [...operators.equality]),
        }),
        checkbox: (field) => ({
            type: withOperators_1.default(field, graphql_1.GraphQLBoolean, parentName, [...operators.equality]),
        }),
        select: (field) => ({
            type: withOperators_1.default(field, new graphql_1.GraphQLEnumType({
                name: `${combineParentName_1.default(parentName, field.name)}_Input`,
                values: field.options.reduce((values, option) => {
                    if (typeof option === 'object' && option.value) {
                        return {
                            ...values,
                            [formatName_1.default(option.value)]: {
                                value: option.value,
                            },
                        };
                    }
                    if (typeof option === 'string') {
                        return {
                            ...values,
                            [option]: {
                                value: option,
                            },
                        };
                    }
                    return values;
                }, {}),
            }), parentName, [...operators.equality, ...operators.contains]),
        }),
        array: (field) => recursivelyBuildNestedPaths(field),
        group: (field) => recursivelyBuildNestedPaths(field),
        row: (field) => field.fields.reduce((rowSchema, rowField) => {
            const getFieldSchema = fieldToSchemaMap[rowField.type];
            if (getFieldSchema) {
                const rowFieldSchema = getFieldSchema(rowField);
                if (Array.isArray(rowFieldSchema)) {
                    return [
                        ...rowSchema,
                        ...rowFieldSchema,
                    ];
                }
                return [
                    ...rowSchema,
                    {
                        key: rowField.name,
                        type: rowFieldSchema,
                    },
                ];
            }
            return rowSchema;
        }, []),
    };
    const fieldTypes = fields.reduce((schema, field) => {
        if (!field.hidden) {
            const getFieldSchema = fieldToSchemaMap[field.type];
            if (getFieldSchema) {
                const fieldSchema = getFieldSchema(field);
                if (Array.isArray(fieldSchema)) {
                    return {
                        ...schema,
                        ...(fieldSchema.reduce((subFields, subField) => ({
                            ...subFields,
                            [formatName_1.default(subField.key)]: subField.type,
                        }), {})),
                    };
                }
                return {
                    ...schema,
                    [formatName_1.default(field.name)]: fieldSchema,
                };
            }
        }
        return schema;
    }, {});
    fieldTypes.id = {
        type: withOperators_1.default({ name: 'id' }, graphql_1.GraphQLString, parentName, [...operators.equality, ...operators.contains]),
    };
    const fieldName = formatName_1.default(name);
    return new graphql_1.GraphQLInputObjectType({
        name: `${fieldName}_where`,
        fields: {
            ...fieldTypes,
            OR: {
                type: new graphql_1.GraphQLList(new graphql_1.GraphQLInputObjectType({
                    name: `${fieldName}_where_or`,
                    fields: {
                        ...fieldTypes,
                    },
                })),
            },
            AND: {
                type: new graphql_1.GraphQLList(new graphql_1.GraphQLInputObjectType({
                    name: `${fieldName}_where_and`,
                    fields: {
                        ...fieldTypes,
                    },
                })),
            },
            page: { type: graphql_1.GraphQLInt },
            limit: { type: graphql_1.GraphQLInt },
            sort: { type: graphql_1.GraphQLString },
        },
    });
};
exports.default = buildWhereInputType;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRXaGVyZUlucHV0VHlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9ncmFwaHFsL3NjaGVtYS9idWlsZFdoZXJlSW5wdXRUeXBlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEseUNBQXlDO0FBQ3pDLHFDQVFpQjtBQUVqQix5REFBZ0Q7QUFFaEQscURBQXlFO0FBQ3pFLHFEQW1CbUM7QUFDbkMseUVBQWlEO0FBQ2pELHVGQUErRDtBQUMvRCxvRUFBNEM7QUFFNUMsaUVBQWlFO0FBQ2pFLG9EQUFvRDtBQUNwRCxFQUFFO0FBQ0Ysc0VBQXNFO0FBQ3RFLCtEQUErRDtBQUMvRCx1RUFBdUU7QUFDdkUsbUVBQW1FO0FBQ25FLE1BQU0sbUJBQW1CLEdBQUcsQ0FBQyxJQUFZLEVBQUUsTUFBZSxFQUFFLFVBQWtCLEVBQTBCLEVBQUU7SUFDeEcsd0RBQXdEO0lBQ3hELGlDQUFpQztJQUNqQyxNQUFNLDJCQUEyQixHQUFHLENBQUMsS0FBeUIsRUFBRSxFQUFFO1FBQ2hFLE1BQU0sV0FBVyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsWUFBWSxFQUFFLFdBQVcsRUFBRSxFQUFFO1lBQ3BFLE1BQU0sY0FBYyxHQUFHLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMxRCxNQUFNLGVBQWUsR0FBRyxHQUFHLEtBQUssQ0FBQyxJQUFJLEtBQUssV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDO1lBRTdELElBQUksY0FBYyxFQUFFO2dCQUNsQixNQUFNLFdBQVcsR0FBRyxjQUFjLENBQUM7b0JBQ2pDLEdBQUcsV0FBVztvQkFDZCxJQUFJLEVBQUUsZUFBZTtpQkFDdEIsQ0FBQyxDQUFDO2dCQUVILElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsRUFBRTtvQkFDOUIsT0FBTzt3QkFDTCxHQUFHLFlBQVk7d0JBQ2YsR0FBRyxXQUFXO3FCQUNmLENBQUM7aUJBQ0g7Z0JBRUQsT0FBTztvQkFDTCxHQUFHLFlBQVk7b0JBQ2Y7d0JBQ0UsR0FBRyxFQUFFLGVBQWU7d0JBQ3BCLElBQUksRUFBRSxXQUFXO3FCQUNsQjtpQkFDRixDQUFDO2FBQ0g7WUFFRCxPQUFPLFlBQVksQ0FBQztRQUN0QixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFUCxPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDLENBQUM7SUFFRixNQUFNLFNBQVMsR0FBRztRQUNoQixRQUFRLEVBQUUsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDO1FBQ2xDLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDO1FBQ2pDLFVBQVUsRUFBRSxDQUFDLG9CQUFvQixFQUFFLGNBQWMsRUFBRSxpQkFBaUIsRUFBRSxXQUFXLENBQUM7S0FDbkYsQ0FBQztJQUVGLE1BQU0sZ0JBQWdCLEdBQUc7UUFDdkIsTUFBTSxFQUFFLENBQUMsS0FBa0IsRUFBRSxFQUFFO1lBQzdCLE1BQU0sSUFBSSxHQUFHLHNCQUFZLENBQUM7WUFDMUIsT0FBTztnQkFDTCxJQUFJLEVBQUUsdUJBQWEsQ0FDakIsS0FBSyxFQUNMLElBQUksRUFDSixVQUFVLEVBQ1YsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxRQUFRLEVBQUUsR0FBRyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQ2pEO2FBQ0YsQ0FBQztRQUNKLENBQUM7UUFDRCxJQUFJLEVBQUUsQ0FBQyxLQUFnQixFQUFFLEVBQUU7WUFDekIsTUFBTSxJQUFJLEdBQUcsdUJBQWEsQ0FBQztZQUMzQixPQUFPO2dCQUNMLElBQUksRUFBRSx1QkFBYSxDQUNqQixLQUFLLEVBQ0wsSUFBSSxFQUNKLFVBQVUsRUFDVixDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FDaEM7YUFDRixDQUFDO1FBQ0osQ0FBQztRQUNELEtBQUssRUFBRSxDQUFDLEtBQWlCLEVBQUUsRUFBRTtZQUMzQixNQUFNLElBQUksR0FBRyxzQ0FBb0IsQ0FBQztZQUNsQyxPQUFPO2dCQUNMLElBQUksRUFBRSx1QkFBYSxDQUNqQixLQUFLLEVBQ0wsSUFBSSxFQUNKLFVBQVUsRUFDVixDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FDaEM7YUFDRixDQUFDO1FBQ0osQ0FBQztRQUNELFFBQVEsRUFBRSxDQUFDLEtBQW9CLEVBQUUsRUFBRTtZQUNqQyxNQUFNLElBQUksR0FBRyx1QkFBYSxDQUFDO1lBQzNCLE9BQU87Z0JBQ0wsSUFBSSxFQUFFLHVCQUFhLENBQ2pCLEtBQUssRUFDTCxJQUFJLEVBQ0osVUFBVSxFQUNWLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUNoQzthQUNGLENBQUM7UUFDSixDQUFDO1FBQ0QsUUFBUSxFQUFFLENBQUMsS0FBb0IsRUFBRSxFQUFFO1lBQ2pDLE1BQU0sSUFBSSxHQUFHLCtCQUFXLENBQUM7WUFDekIsT0FBTztnQkFDTCxJQUFJLEVBQUUsdUJBQWEsQ0FDakIsS0FBSyxFQUNMLElBQUksRUFDSixVQUFVLEVBQ1YsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQ2hDO2FBQ0YsQ0FBQztRQUNKLENBQUM7UUFDRCxJQUFJLEVBQUUsQ0FBQyxLQUFnQixFQUFFLEVBQUU7WUFDekIsTUFBTSxJQUFJLEdBQUcsdUJBQWEsQ0FBQztZQUMzQixPQUFPO2dCQUNMLElBQUksRUFBRSx1QkFBYSxDQUNqQixLQUFLLEVBQ0wsSUFBSSxFQUNKLFVBQVUsRUFDVixDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FDaEM7YUFDRixDQUFDO1FBQ0osQ0FBQztRQUNELEtBQUssRUFBRSxDQUFDLEtBQWlCLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDN0IsSUFBSSxFQUFFLHVCQUFhLENBQ2pCLEtBQUssRUFDTCxJQUFJLHlCQUFlLENBQUM7Z0JBQ2xCLElBQUksRUFBRSxHQUFHLDJCQUFpQixDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVE7Z0JBQzFELE1BQU0sRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsRUFBRTtvQkFDOUMsSUFBSSxzQkFBYyxDQUFDLE1BQU0sQ0FBQyxFQUFFO3dCQUMxQixPQUFPOzRCQUNMLEdBQUcsTUFBTTs0QkFDVCxDQUFDLG9CQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7Z0NBQzFCLEtBQUssRUFBRSxNQUFNLENBQUMsS0FBSzs2QkFDcEI7eUJBQ0YsQ0FBQztxQkFDSDtvQkFFRCxPQUFPO3dCQUNMLEdBQUcsTUFBTTt3QkFDVCxDQUFDLG9CQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRTs0QkFDcEIsS0FBSyxFQUFFLE1BQU07eUJBQ2Q7cUJBQ0YsQ0FBQztnQkFDSixDQUFDLEVBQUUsRUFBRSxDQUFDO2FBQ1AsQ0FBQyxFQUNGLFVBQVUsRUFDVixDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FDaEM7U0FDRixDQUFDO1FBQ0YsSUFBSSxFQUFFLENBQUMsS0FBZ0IsRUFBRSxFQUFFO1lBQ3pCLE1BQU0sSUFBSSxHQUFHLGtDQUFnQixDQUFDO1lBQzlCLE9BQU87Z0JBQ0wsSUFBSSxFQUFFLHVCQUFhLENBQ2pCLEtBQUssRUFDTCxJQUFJLEVBQ0osVUFBVSxFQUNWLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxFQUFFLEdBQUcsU0FBUyxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FDekQ7YUFDRixDQUFDO1FBQ0osQ0FBQztRQUNELFlBQVksRUFBRSxDQUFDLEtBQXdCLEVBQUUsRUFBRTtZQUN6QyxJQUFJLElBQUksR0FBRyx1QkFBYSxDQUN0QixLQUFLLEVBQ0wsdUJBQWEsRUFDYixVQUFVLEVBQ1YsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxRQUFRLEVBQUUsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQy9DLENBQUM7WUFFRixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxFQUFFO2dCQUNuQyxJQUFJLEdBQUcsSUFBSSxnQ0FBc0IsQ0FBQztvQkFDaEMsSUFBSSxFQUFFLEdBQUcsMkJBQWlCLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVztvQkFDN0QsTUFBTSxFQUFFO3dCQUNOLFVBQVUsRUFBRTs0QkFDVixJQUFJLEVBQUUsSUFBSSx5QkFBZSxDQUFDO2dDQUN4QixJQUFJLEVBQUUsR0FBRywyQkFBaUIsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxzQkFBc0I7Z0NBQ3hFLE1BQU0sRUFBRSxLQUFLLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7b0NBQ3JELEdBQUcsTUFBTTtvQ0FDVCxDQUFDLG9CQUFVLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRTt3Q0FDdEIsS0FBSyxFQUFFLFFBQVE7cUNBQ2hCO2lDQUNGLENBQUMsRUFBRSxFQUFFLENBQUM7NkJBQ1IsQ0FBQzt5QkFDSDt3QkFDRCxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsdUJBQWEsRUFBRTtxQkFDL0I7aUJBQ0YsQ0FBQyxDQUFDO2FBQ0o7WUFFRCxJQUFJLEtBQUssQ0FBQyxPQUFPLEVBQUU7Z0JBQ2pCLE9BQU87b0JBQ0wsSUFBSSxFQUFFLElBQUkscUJBQVcsQ0FBQyxJQUFJLENBQUM7aUJBQzVCLENBQUM7YUFDSDtZQUVELE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQztRQUNsQixDQUFDO1FBQ0QsTUFBTSxFQUFFLENBQUMsS0FBa0IsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUMvQixJQUFJLEVBQUUsdUJBQWEsQ0FDakIsS0FBSyxFQUNMLHVCQUFhLEVBQ2IsVUFBVSxFQUNWLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQ3hCO1NBQ0YsQ0FBQztRQUNGLFFBQVEsRUFBRSxDQUFDLEtBQW9CLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDbkMsSUFBSSxFQUFFLHVCQUFhLENBQ2pCLEtBQUssRUFDTCx3QkFBYyxFQUNkLFVBQVUsRUFDVixDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUN4QjtTQUNGLENBQUM7UUFDRixNQUFNLEVBQUUsQ0FBQyxLQUFrQixFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQy9CLElBQUksRUFBRSx1QkFBYSxDQUNqQixLQUFLLEVBQ0wsSUFBSSx5QkFBZSxDQUFDO2dCQUNsQixJQUFJLEVBQUUsR0FBRywyQkFBaUIsQ0FBQyxVQUFVLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRO2dCQUMxRCxNQUFNLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEVBQUU7b0JBQzlDLElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxJQUFJLE1BQU0sQ0FBQyxLQUFLLEVBQUU7d0JBQzlDLE9BQU87NEJBQ0wsR0FBRyxNQUFNOzRCQUNULENBQUMsb0JBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtnQ0FDMUIsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLOzZCQUNwQjt5QkFDRixDQUFDO3FCQUNIO29CQUVELElBQUksT0FBTyxNQUFNLEtBQUssUUFBUSxFQUFFO3dCQUM5QixPQUFPOzRCQUNMLEdBQUcsTUFBTTs0QkFDVCxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dDQUNSLEtBQUssRUFBRSxNQUFNOzZCQUNkO3lCQUNGLENBQUM7cUJBQ0g7b0JBRUQsT0FBTyxNQUFNLENBQUM7Z0JBQ2hCLENBQUMsRUFBRSxFQUFFLENBQUM7YUFDUCxDQUFDLEVBQ0YsVUFBVSxFQUNWLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxFQUFFLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUMvQztTQUNGLENBQUM7UUFDRixLQUFLLEVBQUUsQ0FBQyxLQUFpQixFQUFFLEVBQUUsQ0FBQywyQkFBMkIsQ0FBQyxLQUFLLENBQUM7UUFDaEUsS0FBSyxFQUFFLENBQUMsS0FBaUIsRUFBRSxFQUFFLENBQUMsMkJBQTJCLENBQUMsS0FBSyxDQUFDO1FBQ2hFLEdBQUcsRUFBRSxDQUFDLEtBQWUsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLEVBQUU7WUFDcEUsTUFBTSxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRXZELElBQUksY0FBYyxFQUFFO2dCQUNsQixNQUFNLGNBQWMsR0FBRyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBRWhELElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsRUFBRTtvQkFDakMsT0FBTzt3QkFDTCxHQUFHLFNBQVM7d0JBQ1osR0FBRyxjQUFjO3FCQUNsQixDQUFDO2lCQUNIO2dCQUVELE9BQU87b0JBQ0wsR0FBRyxTQUFTO29CQUNaO3dCQUNFLEdBQUcsRUFBRSxRQUFRLENBQUMsSUFBSTt3QkFDbEIsSUFBSSxFQUFFLGNBQWM7cUJBQ3JCO2lCQUNGLENBQUM7YUFDSDtZQUVELE9BQU8sU0FBUyxDQUFDO1FBQ25CLENBQUMsRUFBRSxFQUFFLENBQUM7S0FDUCxDQUFDO0lBRUYsTUFBTSxVQUFVLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUNqRCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtZQUNqQixNQUFNLGNBQWMsR0FBRyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFcEQsSUFBSSxjQUFjLEVBQUU7Z0JBQ2xCLE1BQU0sV0FBVyxHQUFHLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFFMUMsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFO29CQUM5QixPQUFPO3dCQUNMLEdBQUcsTUFBTTt3QkFDVCxHQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUM7NEJBQy9DLEdBQUcsU0FBUzs0QkFDWixDQUFDLG9CQUFVLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsUUFBUSxDQUFDLElBQUk7eUJBQzFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztxQkFDVCxDQUFDO2lCQUNIO2dCQUVELE9BQU87b0JBQ0wsR0FBRyxNQUFNO29CQUNULENBQUMsb0JBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxXQUFXO2lCQUN0QyxDQUFDO2FBQ0g7U0FDRjtRQUVELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVQLFVBQVUsQ0FBQyxFQUFFLEdBQUc7UUFDZCxJQUFJLEVBQUUsdUJBQWEsQ0FDakIsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFXLEVBQ3ZCLHVCQUFhLEVBQ2IsVUFBVSxFQUNWLENBQUMsR0FBRyxTQUFTLENBQUMsUUFBUSxFQUFFLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUMvQztLQUNGLENBQUM7SUFFRixNQUFNLFNBQVMsR0FBRyxvQkFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRW5DLE9BQU8sSUFBSSxnQ0FBc0IsQ0FBQztRQUNoQyxJQUFJLEVBQUUsR0FBRyxTQUFTLFFBQVE7UUFDMUIsTUFBTSxFQUFFO1lBQ04sR0FBRyxVQUFVO1lBQ2IsRUFBRSxFQUFFO2dCQUNGLElBQUksRUFBRSxJQUFJLHFCQUFXLENBQUMsSUFBSSxnQ0FBc0IsQ0FBQztvQkFDL0MsSUFBSSxFQUFFLEdBQUcsU0FBUyxXQUFXO29CQUM3QixNQUFNLEVBQUU7d0JBQ04sR0FBRyxVQUFVO3FCQUNkO2lCQUNGLENBQUMsQ0FBQzthQUNKO1lBQ0QsR0FBRyxFQUFFO2dCQUNILElBQUksRUFBRSxJQUFJLHFCQUFXLENBQUMsSUFBSSxnQ0FBc0IsQ0FBQztvQkFDL0MsSUFBSSxFQUFFLEdBQUcsU0FBUyxZQUFZO29CQUM5QixNQUFNLEVBQUU7d0JBQ04sR0FBRyxVQUFVO3FCQUNkO2lCQUNGLENBQUMsQ0FBQzthQUNKO1lBQ0QsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLG9CQUFVLEVBQUU7WUFDMUIsS0FBSyxFQUFFLEVBQUUsSUFBSSxFQUFFLG9CQUFVLEVBQUU7WUFDM0IsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLHVCQUFhLEVBQUU7U0FDOUI7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDLENBQUM7QUFFRixrQkFBZSxtQkFBbUIsQ0FBQyJ9