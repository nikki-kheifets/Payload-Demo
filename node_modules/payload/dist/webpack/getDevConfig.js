"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const webpack_1 = __importDefault(require("webpack"));
const getBaseConfig_1 = __importDefault(require("./getBaseConfig"));
exports.default = (payloadConfig) => {
    const baseConfig = getBaseConfig_1.default(payloadConfig);
    let config = {
        ...baseConfig,
        entry: {
            ...baseConfig.entry,
            main: [
                require.resolve('webpack-hot-middleware/client'),
                ...baseConfig.entry.main,
            ],
        },
        output: {
            publicPath: payloadConfig.routes.admin,
            path: '/',
            filename: '[name].js',
        },
        devtool: 'inline-source-map',
        mode: 'development',
        stats: 'errors-warnings',
        plugins: [
            ...baseConfig.plugins,
            new webpack_1.default.HotModuleReplacementPlugin(),
        ],
    };
    config.module.rules.push({
        test: /\.(scss|css)$/,
        sideEffects: true,
        use: [
            require.resolve('style-loader'),
            require.resolve('css-loader'),
            {
                loader: require.resolve('postcss-loader'),
                options: {
                    postcssOptions: {
                        plugins: [require.resolve('postcss-preset-env')],
                    },
                },
            },
            require.resolve('sass-loader'),
        ],
    });
    if (payloadConfig.admin.webpack && typeof payloadConfig.admin.webpack === 'function') {
        config = payloadConfig.admin.webpack(config);
    }
    return config;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0RGV2Q29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3dlYnBhY2svZ2V0RGV2Q29uZmlnLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsc0RBQWlEO0FBRWpELG9FQUE0QztBQUU1QyxrQkFBZSxDQUFDLGFBQThCLEVBQWlCLEVBQUU7SUFDL0QsTUFBTSxVQUFVLEdBQUcsdUJBQWEsQ0FBQyxhQUFhLENBQVEsQ0FBQztJQUV2RCxJQUFJLE1BQU0sR0FBa0I7UUFDMUIsR0FBRyxVQUFVO1FBQ2IsS0FBSyxFQUFFO1lBQ0wsR0FBRyxVQUFVLENBQUMsS0FBSztZQUNuQixJQUFJLEVBQUU7Z0JBQ0osT0FBTyxDQUFDLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQztnQkFDaEQsR0FBSSxVQUFVLENBQUMsS0FBSyxDQUFDLElBQWlCO2FBQ3ZDO1NBQ0Y7UUFDRCxNQUFNLEVBQUU7WUFDTixVQUFVLEVBQUUsYUFBYSxDQUFDLE1BQU0sQ0FBQyxLQUFLO1lBQ3RDLElBQUksRUFBRSxHQUFHO1lBQ1QsUUFBUSxFQUFFLFdBQVc7U0FDdEI7UUFDRCxPQUFPLEVBQUUsbUJBQW1CO1FBQzVCLElBQUksRUFBRSxhQUFhO1FBQ25CLEtBQUssRUFBRSxpQkFBaUI7UUFDeEIsT0FBTyxFQUFFO1lBQ1AsR0FBRyxVQUFVLENBQUMsT0FBTztZQUNyQixJQUFJLGlCQUFPLENBQUMsMEJBQTBCLEVBQUU7U0FDekM7S0FDRixDQUFDO0lBRUYsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBQ3ZCLElBQUksRUFBRSxlQUFlO1FBQ3JCLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLEdBQUcsRUFBRTtZQUNILE9BQU8sQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDO1lBQy9CLE9BQU8sQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDO1lBQzdCO2dCQUNFLE1BQU0sRUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDO2dCQUN6QyxPQUFPLEVBQUU7b0JBQ1AsY0FBYyxFQUFFO3dCQUNkLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsQ0FBQztxQkFDakQ7aUJBQ0Y7YUFDRjtZQUNELE9BQU8sQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDO1NBQy9CO0tBQ0YsQ0FBQyxDQUFDO0lBRUgsSUFBSSxhQUFhLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxPQUFPLGFBQWEsQ0FBQyxLQUFLLENBQUMsT0FBTyxLQUFLLFVBQVUsRUFBRTtRQUNwRixNQUFNLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDOUM7SUFFRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDLENBQUMifQ==